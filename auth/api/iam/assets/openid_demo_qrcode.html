<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>OpenID4VP Demo</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js" integrity="sha512-CNgIRecGo7nphbeZ04Sc13ka07paqdeTu0WR1IM4kNcpmBAUSHSQX0FslNhTDadL4O5SAGapGt4FodqL8My0mA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
</head>
<body style="padding: 20px;">
<h1>OpenID4VP Demo (Verifier)</h1>
<p>This is a demo to have a verifier request a Verifiable Presentation from a wallet by scanning a QR code.</p>
<p>QR code: {{ .QRCode }}</p>
<p>Session ID: {{ .SessionID }}</p>
<div id="qrcode"></div>
<script type="text/javascript">
    var qrcode = new QRCode(document.getElementById("qrcode"), {
        text: "{{ .QRCode }}",
        width: 256,
        height: 256,
        colorDark : "#000000",
        colorLight : "#ffffff",
        correctLevel : QRCode.CorrectLevel.M
    });
    window.setInterval(function () {
        fetch("/iam/{{ .ID }}/openid/session/{{ .SessionID }}")
            .then(response => response.json())
            .then(data => {
                if (data.id_token || data.vp_token) {
                    window.location.href = "/iam/{{ .ID }}/openid_demo_completed?state={{ .SessionID }}";
                }
            });
    }, 2000)
</script>
</body>
</html>