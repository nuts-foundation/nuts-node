@startuml
'https://plantuml.com/sequence-diagram

title Credential Offer (pre-authorized_code flow)

autonumber

box Issuer
    participant Issuer
    participant "Token Endpoint" as TokenEP
    participant "Credential Endpoint" as CredentialEP
end box

box Holder
    participant "Offer Endpoint" as OfferEP
    participant Wallet
end box

group Credential Offer
    Issuer -> OfferEP: CredentialOffer(credentials, (pre-authorized_code))
    OfferEP --> Issuer: Ok
    Wallet -> Issuer: Get Issuer Metadata
    Issuer --> Wallet: Issuer and openid-configuration Metadata
end

group  Get access_token (pre-authorized_code)
    Wallet -> TokenEP: POST issuer/token?pre-authorized_code
    TokenEP --> Wallet: access_token
end

group Get Credential
    Wallet -> CredentialEP: GET credential
    CredentialEP --> Wallet: credential
end



@enduml
